function InfoBox(b){google.maps.OverlayView.call(this);if(b.latLng!=undefined){this.latlng_=b.latlng}if(b.map!=undefined){this.map_=b.map}this.offsetVertical_=0;this.offsetHorizontal_=0;this.offsetPaddingTop=20;this.content=b.content;var a=this;this.boundsChangedListener_=google.maps.event.addListener(this.map_,"bounds_changed",function(){return a.panMap.apply(a)});this.setMap(this.map_)}InfoBox.prototype=new google.maps.OverlayView();InfoBox.prototype.remove=function(){if(this.div_){this.div_.parentNode.removeChild(this.div_);this.div_=null}};InfoBox.prototype.onAdd=function(){this.createElement()};InfoBox.prototype.onRemove=function(){this.remove()};InfoBox.prototype.draw=function(){if(this.latlng_==undefined||this.latlng_==null||this.map_==undefined||this.map_==null||this.content==undefined||this.content==null){return}if(!this.div_){return}var a=this.getProjection().fromLatLngToDivPixel(this.latlng_);if(!a){return}this.div_.style.left=(a.x-($(this.div_).width()/2))+"px";this.div_.style.top=(a.y-$(this.div_).height()-this.offsetPaddingTop)+"px";this.div_.style.display="block"};InfoBox.prototype.createElement=function(){if(this.map_==undefined||this.map_==null||this.latlng_==undefined||this.latlng_==null||this.content==undefined||this.content==null){this.remove();return}var g=this.getPanes();var c=this.div_;if(!c){c=this.div_=document.createElement("div");c.className="bdsInfoWindow";c.style.position="absolute";c.style.width="auto";c.style.height="auto";var e=document.createElement("div");e.className="bdsInfoWindow-head";var d=document.createElement("div");d.className="bdsInfoWindow-body";var b=document.createElement("div");b.innerHTML=this.content;var a=document.createElement("img");a.style.cursor="pointer";a.style.position="absolute";a.style.top="8px";a.style.right="5px";a.src="https://file4.batdongsan.com.vn/images/Product/Maps/close.png";function h(j){return function(){j.setMap(null)}}google.maps.event.addDomListener(a,"click",h(this));d.appendChild(a);d.appendChild(b);e.appendChild(d);c.appendChild(e);c.style.display="none";g.floatPane.appendChild(c);this.eventListeners_=[];var f=["mousemove","mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"];for(i=0;i<f.length;i++){this.eventListeners_.push(google.maps.event.addDomListener(this.div_,f[i],function(j){j.cancelBubble=true;if(j.stopPropagation){j.stopPropagation()}}))}this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(j){this.style.cursor="default"}));this.panMap()}else{if(c.parentNode!=null&&c.parentNode!=g.floatPane){c.parentNode.removeChild(c);c.style.display="none";g.floatPane.appendChild(c)}else{}}};InfoBox.events=["mousedown","mousemove","mouseover","mouseout","mouseup","mousewheel","DOMMouseScroll","touchstart","touchend","touchmove","dblclick","contextmenu","click"];InfoBox.prototype.addCancelHandler_=function(a){if(a.tagName.toLowerCase()=="img"&&a.className=="closeButton"){return}var d=this;for(var c=0,b;b=InfoBox.events[c];c++){this.listeners_.push(google.maps.event.addDomListener(a,b,function(f){if(f.type=="click"){if(f.toElement&&f.toElement.tagName.toLowerCase()=="img"){if(d.avatarClickCallBack_!=null){d.avatarClickCallBack_(d.avatarClickContext_)}}}f.cancelBubble=true;if(f.stopPropagation){f.stopPropagation()}}))}for(var c=0;c<a.childElementCount;c++){this.addCancelHandler_(a.children[c])}};InfoBox.prototype.panMap=function(){var s=this.map_;var a=s.getBounds();if(!a){return}if(this.latlng_==undefined){return}var C=this.latlng_;var p=$(this.div_).width();var j=$(this.div_).height();var l=(p/2)*-1;var m=(j+this.offsetPaddingTop)*-1;var A=40;var B=40;var t=s.getDiv();var z=t.offsetWidth;var v=t.offsetHeight;var b=a.toSpan();var r=b.lng();var q=b.lat();var f=r/z;var g=q/v;var y=a.getSouthWest().lng();var u=a.getNorthEast().lng();var w=a.getNorthEast().lat();var x=a.getSouthWest().lat();var o=C.lng()+(l-A)*f;var h=C.lng()+(l+p+A)*f;var k=C.lat()-(m-B)*g;var n=C.lat()-(m+j+B)*g;var E=(o<y?y-o:0)+(h>u?u-h:0);var D=(k>w?w-k:0)+(n<x?x-n:0);var c=s.getCenter();var d=c.lng()-E;var e=c.lat()-D;s.setCenter(new google.maps.LatLng(e,d));google.maps.event.removeListener(this.boundsChangedListener_);this.boundsChangedListener_=null};InfoBox.prototype.setContent=function(a){this.content=a};InfoBox.prototype.close=function(){this.setMap(null)};InfoBox.prototype.open=function(b,a,c){if(c==undefined){c=20}this.offsetPaddingTop=c+20;this.map_=b;this.latlng_=a.position;this.setMap(this.map_)};